#!/usr/bin/env bash
#
# Runs jekyll as Docker container
#
VOLUME_CONTAINER_NAME=vc_jekyll
VOLUME_CONTAINER_IMAGE=sglahn/vc_jekyll:latest
IMAGE_NAME=jekyll/jekyll:3.7

if [ ! "$(docker ps -a | grep $VOLUME_CONTAINER_NAME)" ]; then
    docker run -u `id -u $USER`:`id -g $USER` --name $VOLUME_CONTAINER_NAME $VOLUME_CONTAINER_IMAGE 
fi

docker run -it --rm \
    -v="$PWD:/srv/jekyll" \
    --volumes-from=$VOLUME_CONTAINER_NAME \
    -p 4000:4000 \
    $IMAGE_NAME \
    jekyll $@
