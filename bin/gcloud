#!/usr/bin/env bash 
#
# Runs Google Cloud SDK as Docker container
#
VOLUME_CONTAINER_NAME=vc_gcloud
VOLUME_CONTAINER_IMAGE=google/cloud-sdk:latest
IMAGE_NAME=google/cloud-sdk:latest

if [ ! "$(docker ps -a | grep $VOLUME_CONTAINER_NAME)" ]; then
    docker run -ti --name $VOLUME_CONTAINER_NAME $VOLUME_CONTAINER_IMAGE gcloud auth login
fi

docker run --rm -ti \
    --volumes-from=$VOLUME_CONTAINER_NAME \
    --net=host \
    -v /var/run/docker.sock:/var/run/docker.sock \
    $IMAGE_NAME \
    gcloud $@
